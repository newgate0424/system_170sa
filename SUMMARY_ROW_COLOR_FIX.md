# ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏µ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢, ‡∏ó‡∏±‡∏Å‡∏ã‡πâ‡∏≥, ‡πÄ‡∏î‡πá‡∏Å

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö
‡πÅ‡∏ñ‡∏ß "‡∏£‡∏ß‡∏°" ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢, ‡∏ó‡∏±‡∏Å‡∏ã‡πâ‡∏≥, ‡πÄ‡∏î‡πá‡∏Å ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°

## ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡∏°‡πà
‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°:
- **‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢**: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢ (%)  
- **‡∏ó‡∏±‡∏Å‡∏ã‡πâ‡∏≥**: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏õ‡πâ‡∏≤‡∏ó‡∏±‡∏Å‡∏ã‡πâ‡∏≥ (%)
- **‡πÄ‡∏î‡πá‡∏Å**: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏õ‡πâ‡∏≤‡πÄ‡∏î‡πá‡∏Å (%)

### ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ:
- **‚â§100%** ‚Üí üü¢ ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏õ‡πâ‡∏≤)
- **>100%** ‚Üí üü° ‡∏™‡∏µ‡πÅ‡∏î‡∏á (‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢)
- **>120%** ‚Üí üî¥ ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° (‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏≤‡∏Å)

## ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡πÉ‡∏ä‡πâ `getSummaryCellStyle()` ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `getQualityMetricsStyle()` ‡πÅ‡∏ï‡πà:
1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô string ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏ä‡πà‡∏ô "5.25%")
2. `getQualityMetricsStyle()` ‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö
3. ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥‡∏Å‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡∏õ‡∏£‡∏±‡∏ö `getQualityMetricsStyle()` ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°:
```typescript
const getQualityMetricsStyle = (row: SheetData, header: string, isSummaryRow: boolean = false) => {
  // ...baseStyle setup...
  
  let actualValue = 0
  
  if (isSummaryRow) {
    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å summaryRow ‡πÄ‡∏õ‡πá‡∏ô string ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏ä‡πà‡∏ô "5.25%")
    const valueStr = String(row[header] || '0').replace(/[%,]/g, '')
    actualValue = parseFloat(valueStr)
  } else {
    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö
    const totalMessages = parseFloat(String(row['Total_Messages'] || '0').replace(/,/g, ''))
    // ... ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å raw data ...
  }
  
  // ... logic ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ...
}
```

### 2. ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏ô `getSummaryCellStyle()`:
```typescript
// ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Lost_Messages, Duplicate, Under_18 ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°
if (header === 'Lost_Messages' || header === 'Duplicate' || header === 'Under_18') {
  const summaryRowData: SheetData = {}
  displayHeaders.forEach(h => {
    summaryRowData[h] = summaryRow[h] || ''
  })
  return getQualityMetricsStyle(summaryRowData, header, true) // true = summary row
}
```

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°:
- **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°**: "6.25%" (‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢)
- **‡πÄ‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢**: 5%
- **‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤**: (6.25/5) √ó 100 = 125%
- **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**: ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° (>120%)

### Debug Logs ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:
```javascript
// ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°
console.log('üìä Lost_Messages Color Calculation (Summary):', {
  actualValue: '6.25',      // ‡∏à‡∏≤‡∏Å summaryRow string
  targetValue: 5,
  percentageOfTarget: '125.00%',
  colorRule: 'DARK_RED'
})

// ‡πÅ‡∏ñ‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥  
console.log('üìä Lost_Messages Color Calculation (Regular):', {
  actualValue: '6.00',      // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å raw data
  targetValue: 5,
  percentageOfTarget: '120.00%',
  colorRule: 'DARK_RED'
})
```

## ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- ‚úÖ **‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏≤‡∏Å summaryRow
- ‚úÖ **‡πÅ‡∏ñ‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥**: ‡∏¢‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö
- ‚úÖ **‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°**: ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡πà‡∏≤ default
- ‚úÖ **‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î**: ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
- ‚úÖ **Debug logs ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô**: ‡πÅ‡∏¢‡∏Å‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Summary ‡πÅ‡∏•‡∏∞ Regular

## ‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
```
1. ‡πÅ‡∏ñ‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥ ‚Üí Raw Data ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì % ‚Üí ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤ ‚Üí ‡∏™‡∏µ
2. ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏° ‚Üí summaryRow["5.25%"] ‚Üí parse 5.25 ‚Üí ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤ ‚Üí ‡∏™‡∏µ
```

## ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- `src/app/overview/page.tsx`: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getQualityMetricsStyle`

## ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
$(Get-Date -Format "dd/MM/yyyy HH:mm:ss")

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à** - ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°)